<!-- Pretty Print for Debug -->
<!-- Usage examples:
     {{/* partial "debugprint.html" .Params */}}
     {{/* partial "debugprint.html" .Site */}}
     {{/* partial "debugprint.html" .GitInfo */}}
-->
{{ $value           := . }}
{{ $type            := (printf "%T" $value) }}
{{ $typeIsBool      := (eq "bool" $type) }}
{{ $typeIsString    := (eq "string" $type) }}
{{ $typeIsTime      := (eq "time.Time" $type) }}
{{ $typeIsInterface := (eq "interface" $type) }}
{{ $typeIsSlice     := (findRE "^([[][]]|.*TaxonomyList)" $type) }} <!-- match ^[] -->
{{ $typeIsMap       := (findRE "^(map[[].+[]]|.*SiteSocial)" $type) }} <!-- match ^map[*] -->

{{ $typeIsSiteInfo  := (eq "*hugolib.SiteInfo" $type) }}
{{ $typeIsGitInfo   := (findRE "^.*gitmap\\.GitInfo" $type) }}
{{ $typeIsFile      := (eq "source.File" $type) }}
{{ $typeIsSpecial   := or $typeIsSiteInfo $typeIsGitInfo $typeIsFile }}

{{ if $typeIsBool }}
    {{ printf "<span class=\"debugprint\"><span class=\"%#v\">%#v</span></span>" $value $value | safeHTML }}
{{ else if $typeIsString }}
    <!-- Use %#v for strings so that their values always get double-quoted.
         That is helpful to tell if a space char is within a string. -->
    {{ printf "%#v" $value | safeHTML }}
{{ else if (or $typeIsTime $typeIsInterface) }}
    {{ printf "%s" $value | safeHTML }}
{{ else if $typeIsSlice }}
    {{ range $value }}
        {{ partial "debugprint.html" . }} <!-- Recursive call FTW! -->
    {{ end }}
{{ else if $typeIsMap }}
    {{ if (gt (len $value) 0) }}
        <table class="debugprint">
            <tr><th class="key">Key</th><th class="type">Type</th><th class="value">Value</th></tr>
            {{ range $key1, $value1 := $value }}
                {{ $type1       := (printf "%T" $value1) }}
                {{ $type1IsTime := (eq "time.Time" $type1) }}
                {{ if $type1IsTime }}
                    <!-- Print the date only if it is not at its initial value of Jan 1, 0001 -->
                    {{ if (ne "0001-01-01" ($value1.Format "2006-01-02")) }}
                        {{ printf "<tr><td class=\"key\">%s</td><td class=\"type\">%s</td><td class=\"value\">" $key1 $type1 | safeHTML }}
                        {{ partial "debugprint.html" $value1 }} <!-- Recursive call FTW! -->
                        {{ printf "</td></tr>" | safeHTML }}
                    {{ end }}
                {{ else }}
                    {{ printf "<tr><td class=\"key\">%s</td><td class=\"type\">%s</td><td class=\"value\">" $key1 $type1 | safeHTML }}
                    {{ partial "debugprint.html" $value1 }} <!-- Recursive call FTW! -->
                    {{ printf "</td></tr>" | safeHTML }}
                {{ end }}
            {{ end }}
        </table>
    {{ end }}
{{ else if $typeIsSpecial }}
    <div class="debugprint">
        {{ if $typeIsSiteInfo }}
            {{ $siteVarNames   := (slice "Title" "Author" "Social" "LastChange" "DisqusShortname" "GoogleAnalytics" "Copyright" "RSSLink" "LanguageCode" "BuildDrafts" "Params") }}
            {{ $siteVarSymbols := (slice .Title  .Author  .Social  .LastChange  .DisqusShortname  .GoogleAnalytics  .Copyright  .RSSLink  .LanguageCode  .BuildDrafts  .Params ) }}
            <table>
                <tr><th class="key">SiteInfo Variable</th><th class="value">Value</th></tr>
                {{ range $idx, $elem := $siteVarNames }}
                    {{ printf "<tr><td class=\"key\">%s</td><td class=\"value\">" $elem | safeHTML }}
                    {{ partial "debugprint.html" (index $siteVarSymbols $idx) }}
                    {{ printf "</td></tr>" | safeHTML }}
                {{ end }}
            </table>
        {{ else if $typeIsGitInfo }}
            {{ $gitInfoVarNames   := (slice "Hash" "AbbreviatedHash" "Subject" "AuthorName" "AuthorEmail" "AuthorDate") }}
            {{ $gitInfoVarSymbols := (slice .Hash  .AbbreviatedHash  .Subject  .AuthorName  .AuthorEmail  .AuthorDate ) }}
            <table>
                <tr><th class="key">GitInfo Variable</th><th class="value">Value</th></tr>
                {{ range $idx, $elem := $gitInfoVarNames }}
                    {{ printf "<tr><td class=\"key\">%s</td><td class=\"value\">" $elem | safeHTML }}
                    {{ partial "debugprint.html" (index $gitInfoVarSymbols $idx) }}
                    {{ printf "</td></tr>" | safeHTML }}
                {{ end }}
            </table>
        {{ else if $typeIsFile }}
            {{ $fileVarNames   := (slice "Path" "LogicalName" "TranslationBaseName" "Ext" "Lang" "Dir") }}
            <!-- Below does not work.. needs to be fixed.
                 The error is seen when you use access this if condition as:
                 {{/* partial "debugprint.html" .File */}}
                 The issue is that I don't know how set the $fileVarSymbols values so that the elements are
                 called as functions instead of fields. i.e. call Path function in .File instead of trying
                 to get the value of the field Path.
            -->
            {{ $fileVarSymbols := (slice .Path  .LogicalName  .TranslationBaseName  .Ext  .Lang  .Dir ) }}
            <table>
                <tr><th class="key">File Variable</th><th class="value">Value</th></tr>
                {{ range $idx, $elem := $fileVarNames }}
                    {{ printf "<tr><td class=\"key\">%s</td><td class=\"value\">" $elem | safeHTML }}
                    {{ partial "debugprint.html" (index $fileVarSymbols $idx) }}
                    {{ printf "</td></tr>" | safeHTML }}
                {{ end }}
            </table>
        {{ else }}
            {{ printf "%#v" $value | safeHTML }}
        {{ end }}
    </div>
{{ else }}
    {{ printf "%#v (type:%s)" $value $type | safeHTML }}
{{ end }}

<!-- Older, simpler version -->
<!-- <table class="debugprint"> -->
{{/* range $key1, $value1 := . */}}
{{/* printf "<tr><td>%#v</td><td>%#v</td></tr>" $key1 $value1 | safeHTML */}}
{{/* end */}}
<!-- </table> -->
